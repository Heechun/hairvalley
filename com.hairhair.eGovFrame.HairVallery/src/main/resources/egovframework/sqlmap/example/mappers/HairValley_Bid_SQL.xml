<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="egovframework.hairhair.hairvalley.service.impl.HairValleyBidMapper">

	<select id="selectBidBoardList" resultType="hairvalleyBidVO" parameterType="java.util.HashMap" >
		<![CDATA[ 
	select * from (SELECT * FROM (SELECT ROWNUM as rnum, text_num, user_id, TO_CHAR(reg_date, 'YYYY/MM/DD') AS reg_date, title, hit FROM hairvalley_bid_board_list) where rnum <= #{endRow}) hairvalley_bid_board_list where rnum >= #{startRow}
	]]> 
	</select>

	
	<select id="selectBidBoardListCount" resultType="java.lang.Integer">
		SELECT MAX(ROWNUM) FROM hairvalley_bid_board_list
	</select>
	
	<update id="updateBidBoardContentCount" parameterType="java.lang.Integer" >
      update hairvalley_bid_board_list set hit= (hit+1) where text_num = #{text_num}
	</update>
	
	<insert id="insertBidBoardData" parameterType="hairvalleyBidInsertVO">
 
    INSERT INTO hairvalley_bid_board_list 
    		(text_num, user_id, reg_date, req_price, perm, cut, dye, add_request, title, hit)
	VALUES (BID_BOARD_LIST_SEQ.nextval, #{user_id}, SYSDATE ,#{req_price},#{perm},#{cut},#{dye},#{add_request},#{title},#{hit})

	</insert>
	<insert id="insertBidBoardUserFaceImage" parameterType="java.lang.String">

	insert into hairvalley_user_face_images (idx, text_num, image_url)
	values (HAIRVALLEY_USER_FACE_IMAG_SEQ.nextval,( select last_number-1 from user_sequences where sequence_name = 'BID_BOARD_LIST_SEQ'),#{url})

	</insert>
	<insert id="insertBidBoardUserRefImage" parameterType="java.lang.String">
 
   insert into hairvalley_user_ref_images (idx, text_num, image_url)
	values (HAIRVALLEY_USER_REF_IMAGE_SEQ.nextval,( select last_number-1 from user_sequences where sequence_name = 'BID_BOARD_LIST_SEQ'),#{url})

	</insert>
	
	
	<select id="selectBidBoardContent" parameterType="java.lang.Integer" resultType="hairvalleyBidVO">
		select text_num, user_id, TO_CHAR(reg_date, 'YYYY/MM/DD') AS reg_date, req_price, perm, cut, dye, add_request, title, hit from hairvalley_bid_board_list where text_num = #{text_num}
	</select>
	
	<select id="selectBidBoardContentFaceImages" parameterType="java.lang.Integer" resultType="HairValleyBidImagesVO">
		select * from hairvalley_user_face_images where text_num = #{text_num}
	</select>
	
	<select id="selectBidBoardContentRefImages" parameterType="java.lang.Integer" resultType="HairValleyBidImagesVO">
		select * from hairvalley_user_ref_images where text_num = #{text_num}
	</select>
	
	
</mapper>